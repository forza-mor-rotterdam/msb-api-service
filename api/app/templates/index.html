<script type="text/javascript">
    function previewFile() {
        const preview = document.querySelector('img');
        const file = document.querySelector('input[type=file]').files[0];
        const reader = new FileReader();
        console.log(window.btoa(file))
        reader.addEventListener("load", function () { 
            preview.src = reader.result; //show image in <img tag>
            base64String = reader.result.replace("data:", "").replace(/^.+,/, "");
            uploadFile(file.name, base64String)
        }, false);

        if (file) {
            reader.readAsDataURL(file);
        }
    }
    function uploadFile(filename, filedata){
        var d = {
            meldingsnummerField: "3000-000117",
            spoedField: true,
            onderwerpField: "Afvalbak",
            xCoordField: 92508.0,
            yCoordField: 437636.0,
            lichtpuntenField: ["017", "035", "036", "037", "038", "039", "040"],
            bijlagenField: [{
              bytesField: "dGltZSxEZWxpdmVyZWQsU3VwcHJlc3NlZCxGYWlsZWQsUG9zdHMgdmlhIFJvdXRlcwpGcmkgRmViIDI2IDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw3LDAsMCwwClNhdCBGZWIgMjcgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDYsMCwwLDAKU3VuIEZlYiAyOCAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksOCwwLDAsMApNb24gTWFyIDAxIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw4LDAsMCwwClR1ZSBNYXIgMDIgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDEwLDAsMCwwCldlZCBNYXIgMDMgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDE2LDAsMCwwClRodSBNYXIgMDQgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDgsMCwwLDAKRnJpIE1hciAwNSAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTIsMCwwLDAKU2F0IE1hciAwNiAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTUsMCwwLDAKU3VuIE1hciAwNyAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTQsMCwwLDAKTW9uIE1hciAwOCAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTIsMCwwLDAKVHVlIE1hciAwOSAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTIsMCwwLDAKV2VkIE1hciAxMCAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksNCwwLDAsMApUaHUgTWFyIDExIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSwxMywwLDAsMApGcmkgTWFyIDEyIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSwxNCwwLDAsMApTYXQgTWFyIDEzIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw2LDAsMCwwClN1biBNYXIgMTQgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDEwLDAsMCwwCk1vbiBNYXIgMTUgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDE4LDAsMCwwClR1ZSBNYXIgMTYgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDEyLDAsMCwwCldlZCBNYXIgMTcgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDQsMCwwLDAKVGh1IE1hciAxOCAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMTEsMCwwLDAKRnJpIE1hciAxOSAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksNiwwLDAsMApTYXQgTWFyIDIwIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw4LDAsMCwwClN1biBNYXIgMjEgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDcsMCwwLDAKTW9uIE1hciAyMiAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMCwwLDAsMApUdWUgTWFyIDIzIDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw1LDAsMCwwCldlZCBNYXIgMjQgMjAyMSAwMTowMDowMCBHTVQrMDEwMCAoTWlkZGVuLUV1cm9wZXNlIHN0YW5kYWFyZHRpamQpLDIsMCwwLDAKVGh1IE1hciAyNSAyMDIxIDAxOjAwOjAwIEdNVCswMTAwIChNaWRkZW4tRXVyb3Blc2Ugc3RhbmRhYXJkdGlqZCksMCwwLDAsMApGcmkgTWFyIDI2IDIwMjEgMDE6MDA6MDAgR01UKzAxMDAgKE1pZGRlbi1FdXJvcGVzZSBzdGFuZGFhcmR0aWpkKSw4LDAsMCww", 
              mimeTypeField: "text/csv", 
              naamField: filename, 
            }],
            //fotosField: [filedata],
        }
         fetch('/AanmakenMelding/', {
               method: 'POST',
               body: JSON.stringify(d),
               headers: {
                'Content-Type': 'application/json'
               }
             })
             .then(response => {
               console.log(response);
             })
             .catch(error => {
               console.error(error);
             });
      }

</script>
<input type="file" onchange="previewFile()"><br>
<img height="200" alt="Image preview...">